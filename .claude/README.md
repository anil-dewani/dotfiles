# Claude Code Configuration

This directory contains personal configuration for Claude Code.

## Statusline

The custom statusline displays useful session metrics in a colorful, three-line format with intelligent cost calculation in INR.

### Features

**Line 1: Session & Context Overview**
- 󰧑 **Model** - Current Claude model (e.g., sonnet-4-5, opus-4.5)
- **Git Branch** - Current git branch
- 󱤓 **Context Usage** - Percentage and absolute numbers (used/limit)
  - Color-coded: green < 60%, yellow < 80%, red ≥ 80%
- **Session Duration** - Time spent in current session
- **Current Time** - Clock time in HH:MM format

**Line 2: Token Metrics & Efficiency**
- 󰙨 **Input Tokens** - Tokens sent to Claude (formatted with commas)
- 󰙩 **Output Tokens** - Tokens generated by Claude
- 󰃨 **Cached Tokens** - Cache reads with hit rate percentage
  - Shows cache efficiency: higher % = better cost savings
- 󰆙 **Total Tokens** - Combined input + output tokens

**Line 3: Cost & Repository Status**
- ₹ **Cost in INR** - Session cost calculated from actual token usage
  - Uses official Claude API pricing (updated for 2026)
  - Supports all models: Opus 4.5, Opus 4, Sonnet 4.5, Haiku
  - Includes cache write/read token costs
  - USD to INR conversion at ~90 INR/USD
- **Git Changes** - Number of uncommitted changes
  - Color-coded: green (0), yellow (1-4), orange (5+)
- **Working Directory** - Current directory (shortened if long)

### How Cost Calculation Works

The statusline calculates costs based on actual token usage using official Claude API pricing:

**Pricing per Million Tokens (2026 rates):**

| Model | Input | Output | Cache Write | Cache Read |
|-------|-------|--------|-------------|------------|
| Opus 4.5 | $5 | $25 | $6.25 | $0.50 |
| Opus 4 | $15 | $75 | $18.75 | $1.50 |
| Sonnet 4.5 | $3 | $15 | $3.75 | $0.30 |
| Haiku | $1 | $5 | $1.25 | $0.10 |

**Calculation Formula:**
```
Cost (USD) = (Input × Input_Price + Output × Output_Price +
              Cache_Write × Write_Price + Cache_Read × Read_Price) / 1,000,000
Cost (INR) = Cost (USD) × 90
```

This provides accurate, real-time cost tracking regardless of subscription plan, based purely on token consumption.

**Sources:**
- [Claude API Pricing](https://platform.claude.com/docs/en/about-claude/pricing)
- [USD to INR Exchange Rate](https://www.exchange-rates.org/exchange-rate-history/usd-inr-2026)

### Installation

The statusline is configured to run automatically when you use Claude Code. To enable it:

1. **Symlink or copy** this `.claude` directory to your home directory:
   ```bash
   ln -s ~/dotfiles/.claude ~/.claude
   # OR
   cp -r ~/dotfiles/.claude ~/.claude
   ```

2. **Ensure jq is installed** (for JSON parsing):
   ```bash
   # macOS
   brew install jq

   # Linux (Debian/Ubuntu)
   sudo apt-get install jq

   # Linux (Fedora/RHEL)
   sudo dnf install jq
   ```

3. **Restart Claude Code** or start a new session

### Customization

You can customize the statusline by editing `statusline.sh`:

**Color Customization:**
- Modify colors by changing the color codes (lines 130-141)
- Use 256-color palette codes: `\033[38;5;NUMm`

**Metrics & Layout:**
- Add or remove metrics by editing the echo statements (lines 190-197)
- Adjust formatting and icons
- Change from 3-line to single-line or different layout

**Cost Calculation:**
- Adjust USD to INR exchange rate by modifying `USD_TO_INR` variable (line 37)
- Pricing is auto-detected based on model name
- Manually adjust pricing in the `get_model_pricing()` function if needed

**Directory Path:**
- Change the path length threshold in `shorten_path()` function (line 158)
- Modify how many directories to show when shortened (line 159)

### Files

- `settings.json` - Claude Code settings file (configures statusline command)
- `statusline.sh` - Custom statusline script
- `README.md` - This documentation file

### Troubleshooting

**Statusline not showing?**
- Verify `~/.claude/settings.json` exists
- Check that `statusline.sh` is executable: `chmod +x ~/.claude/statusline.sh`
- Ensure jq is installed: `which jq`

**Colors not displaying?**
- Your terminal must support 256 colors
- Try a modern terminal like Alacritty, iTerm2, or WezTerm

**Metrics showing as 0 or "unknown"?**
- This is normal for fields that Claude Code doesn't populate
- The script gracefully handles missing data

### Advanced Options

For more advanced statusline features, consider:
- [rz1989s/claude-code-statusline](https://github.com/rz1989s/claude-code-statusline) - 18 atomic components, themes, MCP monitoring
- [ccstatusline](https://github.com/sirmalloc/ccstatusline) - Interactive UI configuration

You can use the `/statusline` command in Claude Code for interactive configuration.
